{% extends "storyshare/base.html" %}

{% block title %}Welcome!{% endblock %}
{% block content %}
    {% if request.user.is_authenticated %}
        <h1>Write Helper</h1>
        <p>Hello {{ request.user }}! Today is {{ today }}.</p>

        <hr>

        <div id="today">
            <h2>Goal: <strong>{{ goal }}</strong> words per day.</h2>
            {% if words_left > 0 %}
                <span class="cross">✗</span>
            {% else %}
                <span class="check">✔</span>
            {% endif %}
            <p>So far today, you've written {{ todays_writings.wordcount }} words.</p>
            {% if words_left > 0 %}
                <p>You still have {{ words_left }} words left to write today to meet your goal.</p>
                <p>Why not <a href="{% url 'storyshare:write' %}">write</a> a bit more?</p>
            {% else %}
                <p>You've met your goal for the day! Congratulations!
            {% endif %}
        </div>

        <hr>

        <div id="streaks">
            <h2>Streaks</h2>
            <div>Current Streak: {{ current_streak }}</div>
            <div>Longest Streak: {{ longest_streak }}</div>
            <p>Your current streak is the number of days in a row that you've met your goal.</p>
        </div>

        <hr>

        <div id="history">

            <h2>History</h2>
            <div id="previousdays">
                <h3>Daily history</h3>
                    <p>
                        <span class="check">✔</span>: met daily goal |
                        <span class="cross">✗</span>: didn't meet goal
                        {% if not writings_by_day %}
                            <p>You only registered today, so there's nothing to display here yet.</p>
                        {% endif %}
                    </p>
                <ol>
                    {% for day in writings_by_day %}
                        <li>
                            <span class="date">{{ day.when }}</span>
                            {% if day.wordcount >= goal %}
                                <span class="check">✔<span>
                            {% else %}
                                <span class="cross">✗</span>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ol>
            </div>

            <div id="recentwritings">
                <h3>Recent writings</h3>
                     <p>
                        {% if recents %}
                            Your past few writings.
                        {% else %}
                            <p>
                                You haven't written anything yet! Why not
                                <a href="{% url 'storyshare:write' %}">start?</a>
                            </p>
                        {% endif %}
                    </p>

                    <ol>
                    {% for writing in recents %}
                        <li>
                            <a href="{% url 'storyshare:viewwriting' writing.url_id %}">{{ writing.title }} • {{ writing.time }}</a>
                        </li>
                    {% endfor %}
                </ol>
            </div>
        </div>
    {% endif %}
{% endblock %}
